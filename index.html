<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iHerb X Ada - Pricing + ROI Calculator - V11</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
:root{--P:#3B7A0D;--PD:#2D5F0A;--PL:#5FA033;--PBG:#F0F9E8;--W:#fff;--D:#111827;--GY:#6b7280;--BD:#e5e7eb;--CR:#f9fafb;--GR:#10b981;--RD:#ef4444;--AM:#f59e0b;--BL:#3B82F6}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',-apple-system,sans-serif;background:#f0f9e8;min-height:100vh}
input[type=number]{width:100%;padding:5px 8px;border:1px solid var(--BD);border-radius:6px;font-size:12px;font-family:inherit;color:var(--D)}
input[type=number]:disabled{background:#f3f4f6}
input[type=range]{width:100%;accent-color:var(--P);margin:0}
.header{background:linear-gradient(135deg,var(--PD),var(--P));padding:16px 28px;display:flex;align-items:center;gap:14}
.header .logo{background:var(--W);border-radius:8px;padding:5px 14px;font-weight:800;color:var(--P);font-size:16px}
.header h1{font-size:18px;font-weight:700;color:var(--W)}
.header .sub{font-size:11px;color:#ddd6fe}
.header .badge{margin-left:auto;background:rgba(255,255,255,.15);border-radius:8px;padding:5px 14px;font-size:11px;color:var(--W);font-weight:600}
.layout{display:flex;min-height:calc(100vh - 60px)}
.left{width:320px;background:#f4f9f0;border-right:1px solid var(--BD);padding:16px 18px;overflow-y:auto;flex-shrink:0}
.right{flex:1;padding:20px;overflow-y:auto}
.card{background:var(--W);border-radius:12px;padding:18px;border:1px solid var(--BD);margin-bottom:16px}
.section-title{font-size:13px;font-weight:700;color:var(--D);margin-bottom:10px}
.inp-group{margin-bottom:12px}
.inp-group label{font-size:11px;font-weight:600;color:var(--D);display:block}
.inp-group .sub{font-size:9px;color:var(--GY)}
.inp-row{display:flex;align-items:center;gap:4px;margin-top:3px}
.inp-row .pre,.inp-row .suf{font-size:11px;color:var(--GY);white-space:nowrap}
.total-box{background:var(--PBG);border-radius:8px;padding:8px 10px;margin-bottom:12px}
.total-box .val{font-size:18px;font-weight:800;color:var(--P)}
.total-box .lbl{font-size:10px;color:var(--GY)}
.toggle-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}
.toggle{width:36px;height:20px;border-radius:10px;cursor:pointer;position:relative;transition:background .2s;flex-shrink:0}
.toggle .dot{width:16px;height:16px;border-radius:8px;background:var(--W);position:absolute;top:2px;transition:left .2s;box-shadow:0 1px 3px rgba(0,0,0,.2)}
.ar-section{margin-bottom:14px}
.ar-label{font-size:11px;font-weight:700;padding:2px 10px;border-radius:10px;display:inline-block}
.ar-sliders{display:flex;gap:16px;margin-top:8px}
.ar-sliders>div{flex:1;text-align:center}
.ar-sliders .yr{font-size:9px;color:var(--GY);font-weight:600;margin-bottom:4px}
.ar-sliders .pct{font-size:14px;font-weight:800;margin-top:2px}
.divider{border-top:1px solid var(--BD);margin-top:14px;padding-top:14px}
/* Left panel light overrides */
.left .section-title{color:var(--D)}
.left .inp-group label{color:var(--D)}
.left .inp-group .sub{color:var(--GY)}
.left .inp-row .pre,.left .inp-row .suf{color:var(--GY)}
.left .total-box{background:#e2f0d9}
.left .total-box .val{color:var(--P)}
.left .total-box .lbl{color:var(--GY)}
.left .divider{border-top-color:var(--BD)}
.left .ar-sliders .yr{color:var(--GY)}
.left .ar-sliders .pct{color:var(--P)}
.left input[type=number]{background:var(--W);border-color:var(--BD);color:var(--D)}
.left input[type=range]{accent-color:#5FA033}
.kpi-row{display:flex;gap:10px;margin-bottom:16px}
.kpi{flex:1;background:var(--PBG);border-radius:10px;padding:14px 10px;text-align:center;border:1px solid rgba(108,43,217,.13)}
.kpi .val{font-size:20px;font-weight:800;color:var(--P)}
.kpi .lbl{font-size:10px;font-weight:600;color:var(--D);margin-top:2px}
.kpi .sub{font-size:8px;color:var(--GY);margin-top:1px}
table{width:100%;border-collapse:collapse;font-size:11px}
table thead tr{background:var(--P)}
table thead th{padding:6px 8px;color:var(--W);font-weight:600;font-size:10px}
table thead th:first-child{text-align:left}
table thead th:not(:first-child){text-align:right}
table tbody td{padding:5px 8px;border-bottom:1px solid var(--BD)}
table tbody td:not(:first-child){text-align:right}
.tier-header{font-size:11px;font-weight:700;color:var(--W);background:#374151;padding:6px 10px;border-radius:6px 6px 0 0;text-align:center}
.tier-table{border:1px solid var(--BD);font-size:10px}
.tier-table th{padding:5px 8px;background:var(--CR);font-weight:700;border-bottom:1px solid var(--BD)}
.tier-table td{padding:4px 8px;border-bottom:1px solid var(--BD)}
.eff-rates{display:flex;gap:12px;margin-top:10px}
.eff-rate{flex:1;background:var(--PBG);border-radius:8px;padding:8px 10px;text-align:center}
.eff-rate .val{font-size:14px;font-weight:800;color:var(--P)}
.chart-legend{display:flex;justify-content:center;gap:20px;font-size:10px;color:var(--GY);margin-top:8px}
.chart-legend span::before{content:'';display:inline-block;width:10px;height:10px;border-radius:2px;margin-right:4px;vertical-align:middle}
.chart-legend .sav::before{background:var(--P)}
.chart-legend .ada::before{background:var(--RD)}
</style>
</head>
<body>

<div class="header">
  <div><h1>iHerb X Ada - Pricing + ROI Calculator</h1></div>
  <div class="badge">Interactive Model</div>
</div>

<div class="layout">
<div class="left">
  <div class="section-title">Conversation Volume (Monthly)</div>

  <div class="inp-group">
    <label>Web Chat</label><div class="sub">Current platform - always active</div>
    <div class="inp-row"><input type="number" id="web" value="75000" min="0" oninput="calc()"><span class="suf">/mo</span></div>
  </div>

  <div class="inp-group">
    <div class="toggle-row">
      <div><label>Search Bar</label><div class="sub">Search bar conversations</div></div>
      <div class="toggle" id="appToggle" onclick="toggleCh('app')" style="background:var(--P)"><div class="dot" style="left:18px"></div></div>
    </div>
    <div id="appInput" class="inp-row"><input type="number" id="appVol" value="13837" min="0" oninput="calc()"><span class="suf">/mo</span></div>
  </div>

  <div class="inp-group">
    <div class="toggle-row">
      <div><label>Email</label><div class="sub">Email automation conversations</div></div>
      <div class="toggle" id="emlToggle" onclick="toggleCh('eml')" style="background:var(--BD)"><div class="dot" style="left:2px"></div></div>
    </div>
    <div id="emlInput" class="inp-row" style="display:none"><input type="number" id="emlVol" value="0" min="0" oninput="calc()"><span class="suf">/mo</span></div>
  </div>

  <div class="inp-group">
    <div class="toggle-row">
      <div><label>Voice</label><div class="sub">Voice/phone automation</div></div>
      <div class="toggle" id="voiToggle" onclick="toggleCh('voi')" style="background:var(--BD)"><div class="dot" style="left:2px"></div></div>
    </div>
    <div id="voiInput" class="inp-row" style="display:none"><input type="number" id="voiVol" value="0" min="0" oninput="calc()"><span class="suf">/mo</span></div>
  </div>

  <div class="total-box">
    <div class="lbl">Total Monthly</div>
    <div class="val" id="totalMo">88,837</div>
    <div class="lbl"><span id="growthLabel">10</span>% YoY growth applied in model</div>
  </div>

  <div style="font-size:12px;font-weight:800;color:#000;margin-bottom:10px;text-transform:uppercase;letter-spacing:.5px">AI Performance - Automated Resolution Rate</div>

  <div class="ar-section">
    <span class="ar-label" style="color:var(--P);background:#3B7A0D18">Messaging</span>
    <div class="ar-sliders">
      <div><div class="yr">Year 1</div><input type="range" min="0" max="100" value="48" id="m1" oninput="calc()"><div class="pct" style="color:var(--P)" id="m1v">48%</div></div>
      <div><div class="yr">Year 2</div><input type="range" min="0" max="100" value="58" id="m2" oninput="calc()"><div class="pct" style="color:var(--P)" id="m2v">58%</div></div>
      <div><div class="yr">Year 3</div><input type="range" min="0" max="100" value="63" id="m3" oninput="calc()"><div class="pct" style="color:var(--P)" id="m3v">63%</div></div>
    </div>
  </div>

  <div class="ar-section" id="sbAR" style="opacity:.5">
    <span class="ar-label" style="color:var(--BL);background:#3B82F618">Search Bar</span>
    <span style="font-size:9px;color:var(--RD);margin-left:4px" id="sbHint">(enable Search Bar above)</span>
    <div class="ar-sliders">
      <div><div class="yr">Year 1</div><input type="range" min="0" max="100" value="88" id="s1" oninput="calc()" style="accent-color:var(--BL)"><div class="pct" style="color:var(--BL)" id="s1v">88%</div></div>
      <div><div class="yr">Year 2</div><input type="range" min="0" max="100" value="60" id="s2" oninput="calc()" style="accent-color:var(--BL)"><div class="pct" style="color:var(--BL)" id="s2v">60%</div></div>
      <div><div class="yr">Year 3</div><input type="range" min="0" max="100" value="70" id="s3" oninput="calc()" style="accent-color:var(--BL)"><div class="pct" style="color:var(--BL)" id="s3v">70%</div></div>
    </div>
  </div>

  <div class="ar-section" id="emlAR" style="opacity:.5">
    <span class="ar-label" style="color:var(--GR);background:#10b98118">Email</span>
    <span style="font-size:9px;color:var(--RD);margin-left:4px">(enable Email above)</span>
    <div class="ar-sliders">
      <div><div class="yr">Year 1</div><input type="range" min="0" max="100" value="30" id="e1" oninput="calc()" style="accent-color:var(--GR)"><div class="pct" style="color:var(--GR)" id="e1v">30%</div></div>
      <div><div class="yr">Year 2</div><input type="range" min="0" max="100" value="33" id="e2" oninput="calc()" style="accent-color:var(--GR)"><div class="pct" style="color:var(--GR)" id="e2v">33%</div></div>
      <div><div class="yr">Year 3</div><input type="range" min="0" max="100" value="36" id="e3" oninput="calc()" style="accent-color:var(--GR)"><div class="pct" style="color:var(--GR)" id="e3v">36%</div></div>
    </div>
  </div>

  <div class="ar-section" id="voiAR" style="opacity:.5">
    <span class="ar-label" style="color:var(--AM);background:#f59e0b18">Voice</span>
    <span style="font-size:9px;color:var(--RD);margin-left:4px">(enable Voice above)</span>
    <div class="ar-sliders">
      <div><div class="yr">Year 1</div><input type="range" min="0" max="100" value="25" id="v1" oninput="calc()" style="accent-color:var(--AM)"><div class="pct" style="color:var(--AM)" id="v1v">25%</div></div>
      <div><div class="yr">Year 2</div><input type="range" min="0" max="100" value="30" id="v2" oninput="calc()" style="accent-color:var(--AM)"><div class="pct" style="color:var(--AM)" id="v2v">30%</div></div>
      <div><div class="yr">Year 3</div><input type="range" min="0" max="100" value="35" id="v3" oninput="calc()" style="accent-color:var(--AM)"><div class="pct" style="color:var(--AM)" id="v3v">35%</div></div>
    </div>
  </div>

  <div class="divider">
    <div class="section-title">Cost Assumptions</div>
    <div class="inp-group"><label>Cost per Ticket (Handled by Human)</label><div class="inp-row"><span class="pre">$</span><input type="number" id="cpc" value="2.61" min="0" step="0.01" oninput="calc()"></div></div>
    <div class="inp-group"><label>Average Handle Time - AHT (Mins)</label><div class="inp-row"><input type="number" id="aht" value="12" min="0" step="0.5" oninput="calc()"><span class="suf">mins</span></div></div>
    <div class="inp-group"><label>Volume growth rate (YoY)</label><div class="inp-row"><input type="number" id="growth" value="10" min="0" oninput="calc()"><span class="suf">%</span></div></div>
  </div>
</div>

<div class="right">
  <!-- PRICING -->
  <div class="card">
    <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px"><span style="font-size:16px">&#128176;</span><span class="section-title" style="margin:0">Ada Pricing</span></div>
    <div style="display:flex;gap:16px;margin-bottom:16px">
      <div style="flex:1">
        <div class="tier-header">Messaging Conversations Price by Volume</div>
        <table class="tier-table"><thead><tr><th style="text-align:left">Tier Start</th><th style="text-align:left">Tier End</th><th style="text-align:right">Cost/Conv</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>1,500,000</td><td style="text-align:right;font-weight:600;color:var(--P)">$0.32</td></tr>
          <tr><td>1,500,001</td><td>2,000,000</td><td style="text-align:right;font-weight:600;color:var(--P)">$0.28</td></tr>
          <tr><td>2,000,001+</td><td></td><td style="text-align:right;font-weight:600;color:var(--P)">$0.25</td></tr>
        </tbody></table>
        <div style="font-size:9px;color:var(--GY);margin-top:4px">Applies to: Web Chat, Search Bar, Email</div>
      </div>
      <div style="flex:1">
        <div class="tier-header">Voice Conversations Price by Volume</div>
        <table class="tier-table"><thead><tr><th style="text-align:left">Tier Start</th><th style="text-align:left">Tier End</th><th style="text-align:right">Cost/Conv</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>100,000</td><td style="text-align:right;font-weight:600;color:var(--AM)">$0.95</td></tr>
          <tr><td>100,001</td><td>200,000</td><td style="text-align:right;font-weight:600;color:var(--AM)">$0.92</td></tr>
          <tr><td>200,001</td><td>300,000</td><td style="text-align:right;font-weight:600;color:var(--AM)">$0.89</td></tr>
          <tr><td>300,001</td><td>500,000</td><td style="text-align:right;font-weight:600;color:var(--AM)">$0.85</td></tr>
          <tr><td>500,001</td><td>750,000</td><td style="text-align:right;font-weight:600;color:var(--AM)">$0.80</td></tr>
          <tr><td>750,001</td><td>1,000,000</td><td style="text-align:right;font-weight:600;color:var(--AM)">$0.75</td></tr>
          <tr><td>1,000,001+</td><td></td><td style="text-align:right;font-weight:600;color:var(--AM)">$0.70</td></tr>
        </tbody></table>
      </div>
    </div>
    <div style="font-size:12px;font-weight:700;color:var(--D);margin-bottom:6px">Annual Volume &amp; Cost by Channel</div>
    <table><thead><tr><th>Channel</th><th>Yr 1 Vol</th><th>Yr 1 Cost</th><th>Yr 2 Vol</th><th>Yr 2 Cost</th><th>Yr 3 Vol</th><th>Yr 3 Cost</th></tr></thead>
    <tbody id="pricingBody"></tbody></table>
    <div class="eff-rates" id="effRates"></div>
  </div>

  <!-- CHART -->
  <div class="card">
    <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px"><span style="font-size:16px">&#128202;</span><span style="font-size:13px;font-weight:700;color:var(--D)">Savings vs. Ada Investment</span></div>
    <div style="font-size:10px;color:var(--GY);margin-bottom:10px">Annual breakdown by category</div>
    <div id="chart" style="display:flex;align-items:flex-end;justify-content:center;gap:40px;height:210px;padding-bottom:32px;position:relative"></div>
    <div id="chartLabels" style="display:flex;justify-content:center;gap:80px;font-size:11px;font-weight:600;color:var(--D)"></div>
    <div class="chart-legend"><span class="sav">Gross Savings</span><span class="ada">Ada Cost</span></div>
  </div>

  <!-- KPIs -->
  <div class="kpi-row" id="kpis"></div>

  <!-- VOLUME TABLE -->
  <div class="card">
    <div style="font-size:13px;font-weight:700;color:var(--D)">Annual Conversation Volume</div>
    <div style="font-size:9px;color:var(--GY);margin-bottom:8px" id="volSub"></div>
    <table><thead><tr><th>Channel</th><th>Year 1</th><th>Year 2</th><th>Year 3</th><th>3-Year Total</th></tr></thead>
    <tbody id="volBody"></tbody></table>
  </div>

  <!-- FINANCIAL TABLE -->
  <div class="card">
    <div style="font-size:13px;font-weight:700;color:var(--D)">3-Year Financial Model</div>
    <div style="font-size:9px;color:var(--GY);margin-bottom:8px">All values in USD</div>
    <table><thead><tr><th>Line Item</th><th>Year 1</th><th>Year 2</th><th>Year 3</th></tr></thead>
    <tbody id="finBody"></tbody></table>
  </div>
</div>
</div>

<script>
var channels={app:true,eml:false,voi:false};
var defaults={app:13837,eml:10000,voi:5000};
var volIds={app:'appVol',eml:'emlVol',voi:'voiVol'};
var arIds={app:'sbAR',eml:'emlAR',voi:'voiAR'};

function toggleCh(ch){
  channels[ch]=!channels[ch];
  var on=channels[ch];
  var tog=document.getElementById(ch+'Toggle');
  tog.style.background=on?'var(--P)':'var(--BD)';
  tog.querySelector('.dot').style.left=on?'18px':'2px';
  document.getElementById(ch+'Input').style.display=on?'flex':'none';
  if(arIds[ch])document.getElementById(arIds[ch]).style.opacity=on?1:.5;
  document.getElementById(volIds[ch]).value=on?defaults[ch]:0;
  calc();
}

function gv(id){return Number(document.getElementById(id).value)||0}
function fmt(v){return '$'+Math.round(v).toLocaleString()}
function fK(v){return v>=1e6?(v/1e6).toFixed(1)+'M':v>=1e3?Math.round(v/1e3)+'K':v.toString()}

function calcMsgCost(v){
  if(v<=0)return 0;
  if(v<=1500000)return v*0.32;
  if(v<=2000000)return 1500000*0.32+(v-1500000)*0.28;
  return 1500000*0.32+500000*0.28+(v-2000000)*0.25;
}

function calcVoiceCost(v){
  if(v<=0)return 0;
  var t=[[100000,0.95],[200000,0.92],[300000,0.89],[500000,0.85],[750000,0.80],[1000000,0.75],[Infinity,0.70]];
  var c=0,r=v,p=0;
  for(var i=0;i<t.length;i++){
    var k=Math.min(r,t[i][0]-p);
    if(k<=0)break;
    c+=k*t[i][1];r-=k;p=t[i][0];
    if(r<=0)break;
  }
  return c;
}

function calc(){
  var web=gv('web'),app=gv('appVol'),eml=gv('emlVol'),voi=gv('voiVol');
  var cpc=gv('cpc'),gr=gv('growth')/100;
  var aht=gv('aht');

  // Update AR labels
  var arList=['m1','m2','m3','s1','s2','s3','e1','e2','e3','v1','v2','v3'];
  for(var a=0;a<arList.length;a++){
    var id=arList[a];
    document.getElementById(id+'v').textContent=gv(id)+'%';
  }

  var tMo=web+app+eml+voi;
  document.getElementById('totalMo').textContent=tMo.toLocaleString();
  document.getElementById('growthLabel').textContent=Math.round(gr*100);
  document.getElementById('volSub').textContent=Math.round(gr*100)+'% YoY growth applied to Year 1 inputs';

  // Search Bar AR active state
  document.getElementById('sbAR').style.opacity=channels.app?1:0.5;

  // Yearly volumes
  function yoy(mo){return [mo*12,Math.round(mo*12*(1+gr)),Math.round(mo*12*Math.pow(1+gr,2))];}
  var wY=yoy(web),aY=yoy(app),eY=yoy(eml),vY=yoy(voi);
  var tY=[wY[0]+aY[0]+eY[0]+vY[0],wY[1]+aY[1]+eY[1]+vY[1],wY[2]+aY[2]+eY[2]+vY[2]];

  // AR rates
  var mAR=[gv('m1')/100,gv('m2')/100,gv('m3')/100];
  var sAR=[gv('s1')/100,gv('s2')/100,gv('s3')/100];
  var eAR=[gv('e1')/100,gv('e2')/100,gv('e3')/100];
  var vAR=[gv('v1')/100,gv('v2')/100,gv('v3')/100];

  var resY=[],humY=[],savY=[],groY=[],netY=[];
  for(var i=0;i<3;i++){
    resY[i]=Math.round(wY[i]*mAR[i]+aY[i]*sAR[i]+eY[i]*eAR[i]+vY[i]*vAR[i]);
    humY[i]=tY[i]-resY[i];
    savY[i]=resY[i]*cpc;
    groY[i]=savY[i];
  }

  // Ada pricing
  var msgAY=[wY[0]+aY[0]+eY[0],wY[1]+aY[1]+eY[1],wY[2]+aY[2]+eY[2]];
  var msgCY=[calcMsgCost(msgAY[0]),calcMsgCost(msgAY[1]),calcMsgCost(msgAY[2])];
  var voiCY=[calcVoiceCost(vY[0]),calcVoiceCost(vY[1]),calcVoiceCost(vY[2])];
  var adaY=[msgCY[0]+voiCY[0],msgCY[1]+voiCY[1],msgCY[2]+voiCY[2]];

  for(var i=0;i<3;i++) netY[i]=groY[i]-adaY[i];
  var t3S=groY[0]+groY[1]+groY[2];
  var t3N=netY[0]+netY[1]+netY[2];
  var t3A=adaY[0]+adaY[1]+adaY[2];
  var roi=t3A>0?t3N/t3A:0;
  // FTE per year
  var fteY=[];
  for(var i=0;i<3;i++){
    fteY[i]=aht>0?Math.round((resY[i]*(aht/60))/2080):0;
  }
  var fte=fteY[2];

  // === PRICING TABLE ===
  var pb='';
  pb+='<tr style="background:var(--W)"><td style="font-weight:600">Web Chat</td>';
  for(var i=0;i<3;i++) pb+='<td>'+wY[i].toLocaleString()+'</td><td style="color:var(--GY)"></td>';
  pb+='</tr>';
  if(app>0){
    pb+='<tr style="background:var(--CR)"><td style="font-weight:600">Search Bar</td>';
    for(var i=0;i<3;i++) pb+='<td>'+aY[i].toLocaleString()+'</td><td style="color:var(--GY)"></td>';
    pb+='</tr>';
  }
  if(eml>0){
    pb+='<tr style="background:var(--W)"><td style="font-weight:600">Email</td>';
    for(var i=0;i<3;i++) pb+='<td>'+eY[i].toLocaleString()+'</td><td style="color:var(--GY)"></td>';
    pb+='</tr>';
  }
  pb+='<tr style="background:var(--PBG)"><td style="font-weight:700;color:var(--P)">Messaging Total</td>';
  for(var i=0;i<3;i++) pb+='<td style="font-weight:700">'+msgAY[i].toLocaleString()+'</td><td style="font-weight:700;color:var(--P)">'+fmt(msgCY[i])+'</td>';
  pb+='</tr>';
  if(voi>0){
    pb+='<tr style="background:#fffbeb"><td style="font-weight:700;color:#b45309">Voice</td>';
    for(var i=0;i<3;i++) pb+='<td style="font-weight:700">'+vY[i].toLocaleString()+'</td><td style="font-weight:700;color:#b45309">'+fmt(voiCY[i])+'</td>';
    pb+='</tr>';
  }
  pb+='<tr style="background:#111827"><td style="font-weight:800;color:var(--W)">Total Annual Cost</td>';
  for(var i=0;i<3;i++) pb+='<td style="font-weight:700;color:#d1d5db">'+tY[i].toLocaleString()+'</td><td style="font-weight:800;color:var(--W)">'+fmt(adaY[i])+'</td>';
  pb+='</tr>';
  document.getElementById('pricingBody').innerHTML=pb;

  // Effective rates
  var er='';
  for(var i=0;i<3;i++){
    var rate=tY[i]>0?adaY[i]/tY[i]:0;
    er+='<div class="eff-rate"><div style="font-size:9px;color:var(--GY)">Year '+(i+1)+' Eff. Rate</div><div class="val">$'+rate.toFixed(2)+'</div><div style="font-size:8px;color:var(--GY)">per conversation</div></div>';
  }
  document.getElementById('effRates').innerHTML=er;

  // === CHART ===
  var mx=Math.max(groY[0],groY[1],groY[2],adaY[0],adaY[1],adaY[2],1);
  function bH(v){return Math.max(4,(v/mx)*170);}
  var ch='<div style="position:absolute;bottom:28px;left:0;right:0;border-top:1px dashed var(--BD)"></div>';
  for(var i=0;i<3;i++){
    ch+='<div style="text-align:center"><div style="display:flex;gap:6px;align-items:flex-end;justify-content:center">';
    ch+='<div style="display:flex;flex-direction:column;align-items:center"><div style="font-size:9px;color:var(--GR);font-weight:700;margin-bottom:2px">'+fK(groY[i])+'</div><div style="width:40px;height:'+bH(groY[i])+'px;background:linear-gradient(180deg,var(--PL),var(--P));border-radius:6px 6px 0 0"></div></div>';
    ch+='<div style="display:flex;flex-direction:column;align-items:center"><div style="font-size:9px;color:var(--RD);font-weight:700;margin-bottom:2px">'+fK(adaY[i])+'</div><div style="width:40px;height:'+bH(adaY[i])+'px;background:linear-gradient(180deg,#fca5a5,#ef4444);border-radius:6px 6px 0 0"></div></div>';
    ch+='</div><div style="font-size:11px;font-weight:600;color:var(--D);margin-top:6px">Year '+(i+1)+'</div></div>';
  }
  document.getElementById('chart').innerHTML=ch;

  // === KPIs ===
  var kpis=[
    [fmt(t3S),'3-Year Total Savings','Before Ada cost'],
    [fmt(t3N),'3-Year Net ROI','After Ada cost'],
    [roi.toFixed(1)+'x','Year 3 ROI Multiple','Return per $1 invested'],
    [fte,'FTEs Freed (Year 3)','Agent headcount equivalent']
  ];
  var kh='';
  for(var k=0;k<kpis.length;k++){
    kh+='<div class="kpi"><div class="val">'+kpis[k][0]+'</div><div class="lbl">'+kpis[k][1]+'</div><div class="sub">'+kpis[k][2]+'</div></div>';
  }
  document.getElementById('kpis').innerHTML=kh;

  // === VOLUME TABLE ===
  var vb='';
  vb+='<tr style="background:var(--W)"><td style="font-weight:600">Web Chat</td><td>'+wY[0].toLocaleString()+'</td><td>'+wY[1].toLocaleString()+'</td><td>'+wY[2].toLocaleString()+'</td><td>'+(wY[0]+wY[1]+wY[2]).toLocaleString()+'</td></tr>';
  if(app>0) vb+='<tr style="background:var(--CR)"><td style="font-weight:600">Search Bar</td><td>'+aY[0].toLocaleString()+'</td><td>'+aY[1].toLocaleString()+'</td><td>'+aY[2].toLocaleString()+'</td><td>'+(aY[0]+aY[1]+aY[2]).toLocaleString()+'</td></tr>';
  if(eml>0) vb+='<tr style="background:var(--W)"><td style="font-weight:600">Email</td><td>'+eY[0].toLocaleString()+'</td><td>'+eY[1].toLocaleString()+'</td><td>'+eY[2].toLocaleString()+'</td><td>'+(eY[0]+eY[1]+eY[2]).toLocaleString()+'</td></tr>';
  if(voi>0) vb+='<tr style="background:var(--CR)"><td style="font-weight:600">Voice</td><td>'+vY[0].toLocaleString()+'</td><td>'+vY[1].toLocaleString()+'</td><td>'+vY[2].toLocaleString()+'</td><td>'+(vY[0]+vY[1]+vY[2]).toLocaleString()+'</td></tr>';
  vb+='<tr style="background:var(--PBG)"><td style="font-weight:700;color:var(--P)">Total</td><td style="font-weight:700;color:var(--P)">'+tY[0].toLocaleString()+'</td><td style="font-weight:700;color:var(--P)">'+tY[1].toLocaleString()+'</td><td style="font-weight:700;color:var(--P)">'+tY[2].toLocaleString()+'</td><td style="font-weight:700;color:var(--P)">'+(tY[0]+tY[1]+tY[2]).toLocaleString()+'</td></tr>';
  document.getElementById('volBody').innerHTML=vb;

  // === FINANCIAL TABLE ===
  var rows=[
    ['Total Conversations',tY,false,false],
    ['AI Resolved',resY,false,false],
    ['Human Handled',humY,false,false],
    ['FTE Savings',fteY,'yellow',false],
    ['Resolution Savings',savY,false,true],
    ['Gross Savings',groY,true,true],
    ['Ada Cost',adaY,'danger',true],
    ['Net Savings',netY,true,true]
  ];
  var fb='';
  for(var r=0;r<rows.length;r++){
    var row=rows[r],hl=row[2],isF=row[3];
    var bg=hl==='danger'?'background:#fef2f2':hl==='yellow'?'background:#FEF3C7':hl?'background:var(--PBG)':'background:'+(r%2===0?'var(--W)':'var(--CR)');
    var tc=hl==='danger'?'color:var(--RD)':hl==='yellow'?'color:#92400E':hl?'color:var(--P)':'color:var(--D)';
    var fw=(hl)?'font-weight:700':'font-weight:400';
    fb+='<tr style="'+bg+'"><td style="'+fw+';'+tc+'">'+row[0]+'</td>';
    for(var i=0;i<3;i++){
      var val=isF?fmt(row[1][i]):row[1][i].toLocaleString();
      fb+='<td style="'+fw+';'+tc+'">'+val+'</td>';
    }
    fb+='</tr>';
  }
  document.getElementById('finBody').innerHTML=fb;
}

calc();
</script>
</body>
</html>
